# Flood Barrier (스마트 차수막 시스템)

![Flood Barrier Demo](docs/images/flood_barrier_demo.gif)

STM32 기반으로 실내·실외의 수위 변화를 감지하고, 위험 단계에서 자동으로 차수막을 올려 침수를 방지하는 시스템입니다.  
수위 센서, LCD, LED, 부저, 서보모터, IR 리모컨을 사용하여 **자동/수동 제어**와 **시각·청각 경고**를 제공합니다.

---

## 프로젝트 개요

- **목적**
  - 갑작스러운 집중호우나 누수 상황에서 사람이 직접 대응하기 전에,
  - 자동으로 수위를 감지하고 차수막을 올려 피해를 줄이기 위한 소형 프로토타입

- **핵심 아이디어**
  - 수위 센서로 물 높이를 측정
  - 일정 임계값 이상이면 자동으로 차수막 상승
  - LCD/LED/부저로 상태를 직관적으로 표시
  - IR 리모컨으로 수동 개폐 및 모드 전환

---

## 주요 기능

1. **수위 감지 & 상태 표시**
   - 아날로그 수위 센서를 사용하여 실시간 수위 측정
   - 측정 값을 기준으로 `NORMAL / WARNING / FLOOD` 3단계 상태 분류
   - LCD에 현재 시간 또는 수위 + 상태 텍스트 출력

2. **자동 차수막 제어**
   - 위험 단계(`FLOOD`)에서 서보모터를 이용해 차수막을 자동으로 상승
   - 수위가 다시 안전 수준으로 내려가면 차수막 하강
   - 과도한 반복 동작 방지를 위해 히스테리시스(임계값 구간) 적용

3. **경고 시스템**
   - LED: 초록(정상), 노랑(주의), 빨강(위험)
   - 부저: 위험 단계 진입 시 경보음 출력

4. **IR 리모컨 수동 제어**
   - IR 리시버로 리모컨 신호 수신
   - 버튼별 기능 예시
     - 차수막 올리기 / 내리기 / 정지
     - 자동 모드 ↔ 수동 모드 전환
     - 비상 정지

---

## 하드웨어 구성

- STM32 마이크로컨트롤러 보드
- 수위 센서 모듈
- 서보모터 (차수막 구동)
- LCD1602 (I2C 또는 병렬)
- RGB 또는 다색 LED 3개
- 피에조 부저
- IR 리모컨 + IR 리시브 센서
- 3D 프린팅 또는 폼보드로 제작한 차수막 구조물

---

## 펌웨어 구조 (폴더 설명)

- `Core/`
  - `Src/`, `Inc/`에 메인 애플리케이션 코드
  - 수위 측정, 상태 머신, 모터 제어, 리모컨 처리 로직 등
- `Drivers/`
  - HAL 드라이버 및 보드 종속 코드
- `Middlewares/Third_Party/FreeRTOS/Source/`
  - FreeRTOS 커널 소스 (태스크 기반으로 확장 가능)
- `EWARM/`, `STM32CubeIDE/`
  - 각 IDE용 프로젝트 설정 파일

---

## 빌드 & 실행 방법

1. **STM32CubeIDE 사용 시**
   - `STM32CubeIDE` → `File > Open Projects from File System...`
   - 레포 루트(`Flood_barrier`) 선택 후 프로젝트 임포트
   - 타깃 보드/클록/핀 설정을 자신의 보드에 맞게 확인
   - Build 후 Debug 또는 Run으로 보드 플래시에 다운로드

2. **다른 IDE(EWARM 등) 사용 시**
   - `EWARM` 폴더 안의 프로젝트 파일을 IDE에서 열기
   - 동일하게 빌드 및 다운로드 수행

---

## 향후 개선 아이디어

- Wi-Fi 또는 BLE를 붙여 스마트폰 알림 전송
- 실시간 강우량 API / 기상 예보와 연동한 사전 경보
- 여러 개의 센서를 묶은 다채널 차수막 시스템으로 확장
- 간단한 웹 대시보드 또는 PC 모니터링 프로그램 연동
## 시연 장면

| 물 유입 감지 | 수위 상승 / 경고 | 리모컨 수동 제어 | 수위 감소 / 복귀 |
| --- | --- | --- | --- |
| ![](docs/images/demo1.gif) | ![](docs/images/demo2.gif) | ![](docs/images/demo3.gif) | ![](docs/images/demo4.gif) |

